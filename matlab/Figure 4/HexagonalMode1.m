clear
clc

HexagonalMode1TPU=[0,0;0.0300000000000000,0.000198120000000000;0.0600000000000000,0.000785255000000000;0.0900000000000000,0.00175095000000000;0.120000000000000,0.00308525000000000;0.150000000000000,0.00477874000000000;0.180000000000000,0.00682250000000000;0.210000000000000,0.00920818000000000;0.240000000000000,0.0119279000000000;0.270000000000000,0.0149744000000000;0.300000000000000,0.0183410000000000;0.330000000000000,0.0220213000000000;0.360000000000000,0.0260099000000000;0.390000000000000,0.0303017000000000;0.420000000000000,0.0348921000000000;0.450000000000000,0.0397773000000000;0.480000000000000,0.0449541000000000;0.510000000000000,0.0504196000000000;0.540000000000000,0.0561718000000000;0.570000000000000,0.0622094000000000;0.600000000000000,0.0685313000000000;0.630000000000000,0.0751375000000000;0.660000000000000,0.0820284000000000;0.690000000000000,0.0892050000000000;0.720000000000000,0.0966692000000000;0.750000000000000,0.104423000000000;0.780000000000000,0.112471000000000;0.810000000000000,0.120815000000000;0.840000000000000,0.129461000000000;0.870000000000000,0.138413000000000;0.900000000000000,0.147679000000000;0.930000000000000,0.157263000000000;0.960000000000000,0.167175000000000;0.990000000000000,0.177421000000000;1.02000000000000,0.188012000000000;1.05000000000000,0.198956000000000;1.08000000000000,0.210265000000000;1.11000000000000,0.221950000000000;1.14000000000000,0.234022000000000;1.17000000000000,0.246495000000000;1.20000000000000,0.259383000000000;1.23000000000000,0.272700000000000;1.26000000000000,0.286463000000000;1.29000000000000,0.300686000000000;1.32000000000000,0.315388000000000;1.35000000000000,0.330587000000000;1.38000000000000,0.346302000000000;1.41000000000000,0.362552000000000;1.44000000000000,0.379360000000000;1.47000000000000,0.396746000000000;1.50000000000000,0.414733000000000;1.53000000000000,0.433346000000000;1.56000000000000,0.452609000000000;1.59000000000000,0.472548000000000;1.62000000000000,0.493188000000000;1.65000000000000,0.514560000000000;1.68000000000000,0.536690000000000;1.71000000000000,0.559609000000000;1.74000000000000,0.583347000000000;1.77000000000000,0.607937000000000;1.80000000000000,0.633410000000000;1.83000000000000,0.659803000000000;1.86000000000000,0.687148000000000;1.89000000000000,0.715482000000000;1.92000000000000,0.744844000000000;1.95000000000000,0.775270000000000;1.98000000000000,0.806800000000000;2.01000000000000,0.839474000000000;2.04000000000000,0.873335000000000;2.07000000000000,0.908425000000000;2.10000000000000,0.944788000000000;2.13000000000000,0.982469000000000;2.16000000000000,1.02151000000000;2.19000000000000,1.06197000000000;2.22000000000000,1.10389000000000;2.25000000000000,1.14731000000000;2.28000000000000,1.19229000000000;2.31000000000000,1.23889000000000;2.34000000000000,1.28715000000000;2.37000000000000,1.33713000000000;2.40000000000000,1.38889000000000;2.43000000000000,1.44247000000000;2.46000000000000,1.49795000000000;2.49000000000000,1.55537000000000;2.52000000000000,1.61480000000000;2.55000000000000,1.67630000000000;2.58000000000000,1.73993000000000;2.61000000000000,1.80575000000000;2.64000000000000,1.87384000000000;2.67000000000000,1.94425000000000;2.70000000000000,2.01705000000000;2.73000000000000,2.09231000000000;2.76000000000000,2.17011000000000;2.79000000000000,2.25050000000000;2.82000000000000,2.33357000000000;2.85000000000000,2.41938000000000;2.88000000000000,2.50801000000000;2.91000000000000,2.59954000000000;2.94000000000000,2.69403000000000;2.97000000000000,2.79158000000000;3,2.89225000000000];
HexagonalMode1PLA=[0,0;0.0300000000000000,0.00149517000000000;0.0600000000000000,0.00590034000000000;0.0900000000000000,0.0131024000000000;0.120000000000000,0.0229979000000000;0.150000000000000,0.0354935000000000;0.180000000000000,0.0505055000000000;0.210000000000000,0.0679601000000000;0.240000000000000,0.0877935000000000;0.270000000000000,0.109952000000000;0.300000000000000,0.134391000000000;0.330000000000000,0.161077000000000;0.360000000000000,0.189985000000000;0.390000000000000,0.221102000000000;0.420000000000000,0.254423000000000;0.450000000000000,0.289953000000000;0.480000000000000,0.327708000000000;0.510000000000000,0.367712000000000;0.540000000000000,0.410001000000000;0.570000000000000,0.454619000000000;0.600000000000000,0.501620000000000;0.630000000000000,0.551068000000000;0.660000000000000,0.603037000000000;0.690000000000000,0.657609000000000;0.720000000000000,0.714877000000000;0.750000000000000,0.774942000000000;0.780000000000000,0.837915000000000;0.810000000000000,0.903916000000000;0.840000000000000,0.973075000000000;0.870000000000000,1.04553000000000;0.900000000000000,1.12143000000000;0.930000000000000,1.20092000000000;0.960000000000000,1.28419000000000;0.990000000000000,1.37139000000000;1.02000000000000,1.46271000000000;1.05000000000000,1.55834000000000;1.08000000000000,1.65848000000000;1.11000000000000,1.76334000000000;1.14000000000000,1.87313000000000;1.17000000000000,1.98809000000000;1.20000000000000,2.10843000000000;1.23000000000000,2.23440000000000;1.26000000000000,2.36625000000000;1.29000000000000,2.50424000000000;1.32000000000000,2.64863000000000;1.35000000000000,2.79968000000000;1.38000000000000,2.95768000000000;1.41000000000000,3.12292000000000;1.44000000000000,3.29569000000000;1.47000000000000,3.47628000000000;1.50000000000000,3.66502000000000;1.53000000000000,3.86221000000000;1.56000000000000,4.06817000000000;1.59000000000000,4.28324000000000;1.62000000000000,4.50775000000000;1.65000000000000,4.74204000000000;1.68000000000000,4.98648000000000;1.71000000000000,5.24140000000000;1.74000000000000,5.50718000000000;1.77000000000000,5.78419000000000;1.80000000000000,6.07280000000000;1.83000000000000,6.37339000000000;1.86000000000000,6.68637000000000;1.89000000000000,7.01211000000000;1.92000000000000,7.35103000000000;1.95000000000000,7.70353000000000;1.98000000000000,8.07004000000000;2.01000000000000,8.45096000000000;2.04000000000000,8.84672000000000;2.07000000000000,9.25777000000000;2.10000000000000,9.68454000000000;2.13000000000000,10.1275000000000;2.16000000000000,10.5870000000000;2.19000000000000,11.0636000000000;2.22000000000000,11.5578000000000;2.25000000000000,12.0700000000000;2.28000000000000,12.6006000000000;2.31000000000000,13.1502000000000;2.34000000000000,13.7193000000000;2.37000000000000,14.3082000000000;2.40000000000000,14.9177000000000;2.43000000000000,15.5480000000000;2.46000000000000,16.1998000000000;2.49000000000000,16.8736000000000;2.52000000000000,17.5699000000000;2.55000000000000,18.2891000000000;2.58000000000000,19.0319000000000;2.61000000000000,19.7988000000000;2.64000000000000,20.5903000000000;2.67000000000000,21.4069000000000;2.70000000000000,22.2493000000000;2.73000000000000,23.1179000000000;2.76000000000000,24.0133000000000;2.79000000000000,24.9362000000000;2.82000000000000,25.8870000000000;2.85000000000000,26.8664000000000;2.88000000000000,27.8749000000000;2.91000000000000,28.9132000000000;2.94000000000000,29.9817000000000;2.97000000000000,31.0812000000000;3,32.2122000000000];

HexagonalMode1PLA(:,1)=3-abs(HexagonalMode1PLA(:,1));
figure(1)
hold on
plot(HexagonalMode1TPU(:,1),HexagonalMode1TPU(:,2),'r')
plot(HexagonalMode1PLA(:,1),HexagonalMode1PLA(:,2),'b')
plot(HexagonalMode1TPU(:,1),HexagonalMode1TPU(:,2)'+fliplr(HexagonalMode1PLA(:,2)'),'k')
a=HexagonalMode1TPU(:,1);
b=HexagonalMode1TPU(:,2)'+fliplr(HexagonalMode1PLA(:,2)');
plot(a(b==min(b)),min(b),'o')
a(b==min(b))
3-a(b==min(b))
xlabel('Ux [mm]')
ylabel('Strain Energe mJ')
legend('TPU','PLA','total energy','minimum point')
c=fliplr(HexagonalMode1PLA(:,2)');
d=HexagonalMode1TPU(:,2);
E_pla_20=c(b==min(b));
E_tpu_20=d(b==min(b));
E_pla_20_per=E_pla_20/(E_pla_20+E_tpu_20);
E_tpu_20_per=E_tpu_20/(E_pla_20+E_tpu_20);


HexagonalMode1TPU=[0,0;0.0300000000000000,5.77376000000000e-05;0.0600000000000000,0.000228845000000000;0.0900000000000000,0.000510274000000000;0.120000000000000,0.000899126000000000;0.150000000000000,0.00139265000000000;0.180000000000000,0.00198826000000000;0.210000000000000,0.00268351000000000;0.240000000000000,0.00347612000000000;0.270000000000000,0.00436396000000000;0.300000000000000,0.00534506000000000;0.330000000000000,0.00641762000000000;0.360000000000000,0.00758001000000000;0.390000000000000,0.00883074000000000;0.420000000000000,0.0101685000000000;0.450000000000000,0.0115922000000000;0.480000000000000,0.0131008000000000;0.510000000000000,0.0146936000000000;0.540000000000000,0.0163700000000000;0.570000000000000,0.0181295000000000;0.600000000000000,0.0199719000000000;0.630000000000000,0.0218971000000000;0.660000000000000,0.0239053000000000;0.690000000000000,0.0259968000000000;0.720000000000000,0.0281721000000000;0.750000000000000,0.0304318000000000;0.780000000000000,0.0327771000000000;0.810000000000000,0.0352088000000000;0.840000000000000,0.0377284000000000;0.870000000000000,0.0403375000000000;0.900000000000000,0.0430376000000000;0.930000000000000,0.0458308000000000;0.960000000000000,0.0487193000000000;0.990000000000000,0.0517054000000000;1.02000000000000,0.0547918000000000;1.05000000000000,0.0579813000000000;1.08000000000000,0.0612770000000000;1.11000000000000,0.0646822000000000;1.14000000000000,0.0682004000000000;1.17000000000000,0.0718355000000000;1.20000000000000,0.0755913000000000;1.23000000000000,0.0794724000000000;1.26000000000000,0.0834831000000000;1.29000000000000,0.0876282000000000;1.32000000000000,0.0919128000000000;1.35000000000000,0.0963421000000000;1.38000000000000,0.100922000000000;1.41000000000000,0.105658000000000;1.44000000000000,0.110556000000000;1.47000000000000,0.115623000000000;1.50000000000000,0.120865000000000;1.53000000000000,0.126289000000000;1.56000000000000,0.131903000000000;1.59000000000000,0.137713000000000;1.62000000000000,0.143729000000000;1.65000000000000,0.149957000000000;1.68000000000000,0.156406000000000;1.71000000000000,0.163085000000000;1.74000000000000,0.170003000000000;1.77000000000000,0.177169000000000;1.80000000000000,0.184593000000000;1.83000000000000,0.192285000000000;1.86000000000000,0.200254000000000;1.89000000000000,0.208511000000000;1.92000000000000,0.217068000000000;1.95000000000000,0.225935000000000;1.98000000000000,0.235123000000000;2.01000000000000,0.244646000000000;2.04000000000000,0.254514000000000;2.07000000000000,0.264740000000000;2.10000000000000,0.275337000000000;2.13000000000000,0.286318000000000;2.16000000000000,0.297697000000000;2.19000000000000,0.309487000000000;2.22000000000000,0.321702000000000;2.25000000000000,0.334358000000000;2.28000000000000,0.347467000000000;2.31000000000000,0.361047000000000;2.34000000000000,0.375111000000000;2.37000000000000,0.389677000000000;2.40000000000000,0.404760000000000;2.43000000000000,0.420376000000000;2.46000000000000,0.436543000000000;2.49000000000000,0.453278000000000;2.52000000000000,0.470597000000000;2.55000000000000,0.488520000000000;2.58000000000000,0.507063000000000;2.61000000000000,0.526246000000000;2.64000000000000,0.546088000000000;2.67000000000000,0.566607000000000;2.70000000000000,0.587824000000000;2.73000000000000,0.609758000000000;2.76000000000000,0.632429000000000;2.79000000000000,0.655858000000000;2.82000000000000,0.680066000000000;2.85000000000000,0.705073000000000;2.88000000000000,0.730903000000000;2.91000000000000,0.757576000000000;2.94000000000000,0.785115000000000;2.97000000000000,0.813542000000000;3,0.842881000000000];
HexagonalMode1PLA=[0,0;0.0300000000000000,2.17986000000000e-06;0.0600000000000000,7.65346000000000e-06;0.0900000000000000,1.58665000000000e-05;0.120000000000000,2.66061000000000e-05;0.150000000000000,3.97506000000000e-05;0.180000000000000,5.51966000000000e-05;0.210000000000000,7.28467000000000e-05;0.240000000000000,9.26108000000000e-05;0.270000000000000,0.000114410000000000;0.300000000000000,0.000138176000000000;0.330000000000000,0.000163857000000000;0.360000000000000,0.000191414000000000;0.390000000000000,0.000220819000000000;0.420000000000000,0.000252059000000000;0.450000000000000,0.000285134000000000;0.480000000000000,0.000320055000000000;0.510000000000000,0.000356844000000000;0.540000000000000,0.000395534000000000;0.570000000000000,0.000436168000000000;0.600000000000000,0.000478800000000000;0.630000000000000,0.000523491000000000;0.660000000000000,0.000570314000000000;0.690000000000000,0.000619349000000000;0.720000000000000,0.000670686000000000;0.750000000000000,0.000724422000000000;0.780000000000000,0.000780663000000000;0.810000000000000,0.000839522000000000;0.840000000000000,0.000901121000000000;0.870000000000000,0.000965588000000000;0.900000000000000,0.00103306000000000;0.930000000000000,0.00110368000000000;0.960000000000000,0.00117760000000000;0.990000000000000,0.00125498000000000;1.02000000000000,0.00133599000000000;1.05000000000000,0.00142078000000000;1.08000000000000,0.00150955000000000;1.11000000000000,0.00160248000000000;1.14000000000000,0.00169976000000000;1.17000000000000,0.00180158000000000;1.20000000000000,0.00190816000000000;1.23000000000000,0.00201970000000000;1.26000000000000,0.00213643000000000;1.29000000000000,0.00225855000000000;1.32000000000000,0.00238631000000000;1.35000000000000,0.00251995000000000;1.38000000000000,0.00265969000000000;1.41000000000000,0.00280579000000000;1.44000000000000,0.00295850000000000;1.47000000000000,0.00311809000000000;1.50000000000000,0.00328481000000000;1.53000000000000,0.00345893000000000;1.56000000000000,0.00364074000000000;1.59000000000000,0.00383051000000000;1.62000000000000,0.00402854000000000;1.65000000000000,0.00423511000000000;1.68000000000000,0.00445052000000000;1.71000000000000,0.00467508000000000;1.74000000000000,0.00490910000000000;1.77000000000000,0.00515288000000000;1.80000000000000,0.00540675000000000;1.83000000000000,0.00567104000000000;1.86000000000000,0.00594606000000000;1.89000000000000,0.00623217000000000;1.92000000000000,0.00652969000000000;1.95000000000000,0.00683898000000000;1.98000000000000,0.00716037000000000;2.01000000000000,0.00749423000000000;2.04000000000000,0.00784092000000000;2.07000000000000,0.00820080000000000;2.10000000000000,0.00857423000000000;2.13000000000000,0.00896160000000000;2.16000000000000,0.00936328000000000;2.19000000000000,0.00977965000000000;2.22000000000000,0.0102111000000000;2.25000000000000,0.0106580000000000;2.28000000000000,0.0111208000000000;2.31000000000000,0.0115999000000000;2.34000000000000,0.0120957000000000;2.37000000000000,0.0126085000000000;2.40000000000000,0.0131389000000000;2.43000000000000,0.0136872000000000;2.46000000000000,0.0142538000000000;2.49000000000000,0.0148392000000000;2.52000000000000,0.0154438000000000;2.55000000000000,0.0160681000000000;2.58000000000000,0.0167124000000000;2.61000000000000,0.0173773000000000;2.64000000000000,0.0180632000000000;2.67000000000000,0.0187705000000000;2.70000000000000,0.0194997000000000;2.73000000000000,0.0202512000000000;2.76000000000000,0.0210256000000000;2.79000000000000,0.0218232000000000;2.82000000000000,0.0226447000000000;2.85000000000000,0.0234903000000000;2.88000000000000,0.0243607000000000;2.91000000000000,0.0252563000000000;2.94000000000000,0.0261776000000000;2.97000000000000,0.0271251000000000;3,0.0280992000000000];

HexagonalMode1PLA(:,1)=3-abs(HexagonalMode1PLA(:,1));
figure(2)
hold on
plot(HexagonalMode1TPU(:,1),HexagonalMode1TPU(:,2),'r')
plot(HexagonalMode1PLA(:,1),HexagonalMode1PLA(:,2),'b')
plot(HexagonalMode1TPU(:,1),HexagonalMode1TPU(:,2)'+fliplr(HexagonalMode1PLA(:,2)'),'k')
a=HexagonalMode1TPU(:,1);
b=HexagonalMode1TPU(:,2)'+fliplr(HexagonalMode1PLA(:,2)');
plot(a(b==min(b)),min(b),'o')
a(b==min(b))
3-a(b==min(b))
xlabel('Ux [mm]')
ylabel('Strain Energe mJ')
legend('TPU','PLA','total energy','minimum point')
c=fliplr(HexagonalMode1PLA(:,2)');
d=HexagonalMode1TPU(:,2);
E_pla_80=c(b==min(b));
E_tpu_80=d(b==min(b));
E_pla_80_per=E_pla_80/(E_pla_80+E_tpu_80);
E_tpu_80_per=E_tpu_80/(E_pla_80+E_tpu_80);

figure(3)
hold on
plot([20,80],[E_pla_20_per,E_pla_80_per]*100,'h-','Color',[0 0.600000023841858 1],'LineWidth',1.5)
plot([20,80],[E_tpu_20_per,E_tpu_80_per]*100,'h-','Color',[1 0.800000011920929 0.200000002980232],'LineWidth',1.5)
xlabel('Temperature [^oC]')
ylabel('Energy [%]')
legend('PLA','TPU')

figure(4)
hold on
bar(4,E_pla_20+E_tpu_20,'b')