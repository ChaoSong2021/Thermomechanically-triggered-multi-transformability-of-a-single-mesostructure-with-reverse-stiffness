clear
clc

SquareMode1TPU=[0,0;0.0200000000000000,0.00279988000000000;0.0400000000000000,0.0112693000000000;0.0600000000000000,0.0255165000000000;0.0800000000000000,0.0456544000000000;0.100000000000000,0.0718008000000000;0.120000000000000,0.104078000000000;0.140000000000000,0.142615000000000;0.160000000000000,0.187543000000000;0.180000000000000,0.238999000000000;0.200000000000000,0.297127000000000;0.220000000000000,0.362075000000000;0.240000000000000,0.433995000000000;0.260000000000000,0.513045000000000;0.280000000000000,0.599390000000000;0.300000000000000,0.693197000000000;0.320000000000000,0.794642000000000;0.340000000000000,0.903904000000000;0.360000000000000,1.02117000000000;0.380000000000000,1.14663000000000;0.400000000000000,1.28047000000000;0.420000000000000,1.42291000000000;0.440000000000000,1.57415000000000;0.460000000000000,1.73440000000000;0.480000000000000,1.90389000000000;0.500000000000000,2.08283000000000;0.520000000000000,2.27146000000000;0.540000000000000,2.47002000000000;0.560000000000000,2.67876000000000;0.580000000000000,2.89791000000000;0.600000000000000,3.12774000000000;0.620000000000000,3.36850000000000;0.640000000000000,3.62047000000000;0.660000000000000,3.88393000000000;0.680000000000000,4.15914000000000;0.700000000000000,4.44640000000000;0.720000000000000,4.74601000000000;0.740000000000000,5.05826000000000;0.760000000000000,5.38346000000000;0.780000000000000,5.72193000000000;0.800000000000000,6.07397000000000;0.820000000000000,6.43993000000000;0.840000000000000,6.82014000000000;0.860000000000000,7.21492000000000;0.880000000000000,7.62464000000000;0.900000000000000,8.04965000000000;0.920000000000000,8.49030000000000;0.940000000000000,8.94696000000000;0.960000000000000,9.42002000000000;0.980000000000000,9.90984000000000;1,10.4168000000000;1.02000000000000,10.9414000000000;1.04000000000000,11.4839000000000;1.06000000000000,12.0447000000000;1.08000000000000,12.6244000000000;1.10000000000000,13.2232000000000;1.12000000000000,13.8417000000000;1.14000000000000,14.4803000000000;1.16000000000000,15.1393000000000;1.18000000000000,15.8194000000000;1.20000000000000,16.5209000000000;1.22000000000000,17.2443000000000;1.24000000000000,17.9900000000000;1.26000000000000,18.7586000000000;1.28000000000000,19.5506000000000;1.30000000000000,20.3664000000000;1.32000000000000,21.2065000000000;1.34000000000000,22.0714000000000;1.36000000000000,22.9617000000000;1.38000000000000,23.8779000000000;1.40000000000000,24.8205000000000;1.42000000000000,25.7901000000000;1.44000000000000,26.7871000000000;1.46000000000000,27.8122000000000;1.48000000000000,28.8658000000000;1.50000000000000,29.9486000000000;1.52000000000000,31.0612000000000;1.54000000000000,32.2040000000000;1.56000000000000,33.3777000000000;1.58000000000000,34.5829000000000;1.60000000000000,35.8202000000000;1.62000000000000,37.0901000000000;1.64000000000000,38.3933000000000;1.66000000000000,39.7304000000000;1.68000000000000,41.1020000000000;1.70000000000000,42.5088000000000;1.72000000000000,43.9513000000000;1.74000000000000,45.4302000000000;1.76000000000000,46.9461000000000;1.78000000000000,48.4998000000000;1.80000000000000,50.0917000000000;1.82000000000000,51.7227000000000;1.84000000000000,53.3934000000000;1.86000000000000,55.1044000000000;1.88000000000000,56.8564000000000;1.90000000000000,58.6501000000000;1.92000000000000,60.4862000000000;1.94000000000000,62.3653000000000;1.96000000000000,64.2882000000000;1.98000000000000,66.2556000000000;2,68.2681000000000];
SquareMode1PLA=[0,0;0.0200000000000000,0.0183140000000000;0.0400000000000000,0.0734979000000000;0.0600000000000000,0.165962000000000;0.0800000000000000,0.296181000000000;0.100000000000000,0.464691000000000;0.120000000000000,0.672092000000000;0.140000000000000,0.919047000000000;0.160000000000000,1.20628000000000;0.180000000000000,1.53458000000000;0.200000000000000,1.90480000000000;0.220000000000000,2.31783000000000;0.240000000000000,2.77467000000000;0.260000000000000,3.27633000000000;0.280000000000000,3.82391000000000;0.300000000000000,4.41856000000000;0.320000000000000,5.06150000000000;0.340000000000000,5.75399000000000;0.360000000000000,6.49736000000000;0.380000000000000,7.29299000000000;0.400000000000000,8.14234000000000;0.420000000000000,9.04691000000000;0.440000000000000,10.0082000000000;0.460000000000000,11.0280000000000;0.480000000000000,12.1077000000000;0.500000000000000,13.2493000000000;0.520000000000000,14.4544000000000;0.540000000000000,15.7249000000000;0.560000000000000,17.0627000000000;0.580000000000000,18.4698000000000;0.600000000000000,19.9480000000000;0.620000000000000,21.4995000000000;0.640000000000000,23.1263000000000;0.660000000000000,24.8307000000000;0.680000000000000,26.6147000000000;0.700000000000000,28.4807000000000;0.720000000000000,30.4309000000000;0.740000000000000,32.4676000000000;0.760000000000000,34.5934000000000;0.780000000000000,36.8105000000000;0.800000000000000,39.1215000000000;0.820000000000000,41.5289000000000;0.840000000000000,44.0354000000000;0.860000000000000,46.6434000000000;0.880000000000000,49.3557000000000;0.900000000000000,52.1749000000000;0.920000000000000,55.1039000000000;0.940000000000000,58.1454000000000;0.960000000000000,61.3022000000000;0.980000000000000,64.5772000000000;1,67.9734000000000;1.02000000000000,71.4937000000000;1.04000000000000,75.1411000000000;1.06000000000000,78.9185000000000;1.08000000000000,82.8292000000000;1.10000000000000,86.8761000000000;1.12000000000000,91.0625000000000;1.14000000000000,95.3915000000000;1.16000000000000,99.8663000000000;1.18000000000000,104.490000000000;1.20000000000000,109.267000000000;1.22000000000000,114.199000000000;1.24000000000000,119.290000000000;1.26000000000000,124.543000000000;1.28000000000000,129.963000000000;1.30000000000000,135.551000000000;1.32000000000000,141.313000000000;1.34000000000000,147.251000000000;1.36000000000000,153.368000000000;1.38000000000000,159.670000000000;1.40000000000000,166.158000000000;1.42000000000000,172.837000000000;1.44000000000000,179.710000000000;1.46000000000000,186.781000000000;1.48000000000000,194.054000000000;1.50000000000000,201.533000000000;1.52000000000000,209.221000000000;1.54000000000000,217.122000000000;1.56000000000000,225.240000000000;1.58000000000000,233.579000000000;1.60000000000000,242.142000000000;1.62000000000000,250.934000000000;1.64000000000000,259.959000000000;1.66000000000000,269.219000000000;1.68000000000000,278.721000000000;1.70000000000000,288.467000000000;1.72000000000000,298.461000000000;1.74000000000000,308.707000000000;1.76000000000000,319.211000000000;1.78000000000000,329.974000000000;1.80000000000000,341.003000000000;1.82000000000000,352.300000000000;1.84000000000000,363.871000000000;1.86000000000000,375.718000000000;1.88000000000000,387.847000000000;1.90000000000000,400.261000000000;1.92000000000000,412.965000000000;1.94000000000000,425.964000000000;1.96000000000000,439.260000000000;1.98000000000000,452.859000000000;2,466.765000000000];



SquareMode1PLA(:,1)=2-abs(SquareMode1PLA(:,1));
figure(1)
hold on
plot(SquareMode1TPU(:,1),SquareMode1TPU(:,2),'r')
plot(SquareMode1PLA(:,1),SquareMode1PLA(:,2),'b')
plot(SquareMode1TPU(:,1),SquareMode1TPU(:,2)'+fliplr(SquareMode1PLA(:,2)'),'k')
a=SquareMode1TPU(:,1);
b=SquareMode1TPU(:,2)'+fliplr(SquareMode1PLA(:,2)');
plot(a(b==min(b)),min(b),'o')
a(b==min(b))
2-a(b==min(b))
xlabel('Ux [mm]')
ylabel('Strain Energe mJ')
legend('TPU','PLA','total energy','minimum point')
c=fliplr(SquareMode1PLA(:,2)');
d=SquareMode1TPU(:,2);
E_pla_20=c(b==min(b));
E_tpu_20=d(b==min(b));
E_pla_20_per=E_pla_20/(E_pla_20+E_tpu_20);
E_tpu_20_per=E_tpu_20/(E_pla_20+E_tpu_20);


SquareMode1TPU=[0,0;0.0200000000000000,0.000815963000000000;0.0400000000000000,0.00328419000000000;0.0600000000000000,0.00743620000000000;0.0800000000000000,0.0133049000000000;0.100000000000000,0.0209247000000000;0.120000000000000,0.0303313000000000;0.140000000000000,0.0415619000000000;0.160000000000000,0.0546550000000000;0.180000000000000,0.0696509000000000;0.200000000000000,0.0865910000000000;0.220000000000000,0.105518000000000;0.240000000000000,0.126478000000000;0.260000000000000,0.149515000000000;0.280000000000000,0.174679000000000;0.300000000000000,0.202017000000000;0.320000000000000,0.231580000000000;0.340000000000000,0.263422000000000;0.360000000000000,0.297596000000000;0.380000000000000,0.334158000000000;0.400000000000000,0.373165000000000;0.420000000000000,0.414675000000000;0.440000000000000,0.458750000000000;0.460000000000000,0.505452000000000;0.480000000000000,0.554845000000000;0.500000000000000,0.606994000000000;0.520000000000000,0.661967000000000;0.540000000000000,0.719833000000000;0.560000000000000,0.780663000000000;0.580000000000000,0.844530000000000;0.600000000000000,0.911508000000000;0.620000000000000,0.981673000000000;0.640000000000000,1.05510000000000;0.660000000000000,1.13188000000000;0.680000000000000,1.21209000000000;0.700000000000000,1.29580000000000;0.720000000000000,1.38312000000000;0.740000000000000,1.47412000000000;0.760000000000000,1.56889000000000;0.780000000000000,1.66753000000000;0.800000000000000,1.77012000000000;0.820000000000000,1.87677000000000;0.840000000000000,1.98757000000000;0.860000000000000,2.10263000000000;0.880000000000000,2.22203000000000;0.900000000000000,2.34589000000000;0.920000000000000,2.47431000000000;0.940000000000000,2.60739000000000;0.960000000000000,2.74525000000000;0.980000000000000,2.88800000000000;1,3.03575000000000;1.02000000000000,3.18861000000000;1.04000000000000,3.34671000000000;1.06000000000000,3.51016000000000;1.08000000000000,3.67908000000000;1.10000000000000,3.85360000000000;1.12000000000000,4.03385000000000;1.14000000000000,4.21994000000000;1.16000000000000,4.41202000000000;1.18000000000000,4.61021000000000;1.20000000000000,4.81464000000000;1.22000000000000,5.02545000000000;1.24000000000000,5.24278000000000;1.26000000000000,5.46678000000000;1.28000000000000,5.69757000000000;1.30000000000000,5.93531000000000;1.32000000000000,6.18014000000000;1.34000000000000,6.43221000000000;1.36000000000000,6.69167000000000;1.38000000000000,6.95868000000000;1.40000000000000,7.23338000000000;1.42000000000000,7.51593000000000;1.44000000000000,7.80649000000000;1.46000000000000,8.10522000000000;1.48000000000000,8.41229000000000;1.50000000000000,8.72785000000000;1.52000000000000,9.05207000000000;1.54000000000000,9.38513000000000;1.56000000000000,9.72718000000000;1.58000000000000,10.0784000000000;1.60000000000000,10.4390000000000;1.62000000000000,10.8091000000000;1.64000000000000,11.1889000000000;1.66000000000000,11.5785000000000;1.68000000000000,11.9783000000000;1.70000000000000,12.3882000000000;1.72000000000000,12.8086000000000;1.74000000000000,13.2396000000000;1.76000000000000,13.6814000000000;1.78000000000000,14.1342000000000;1.80000000000000,14.5981000000000;1.82000000000000,15.0734000000000;1.84000000000000,15.5603000000000;1.86000000000000,16.0589000000000;1.88000000000000,16.5695000000000;1.90000000000000,17.0922000000000;1.92000000000000,17.6273000000000;1.94000000000000,18.1750000000000;1.96000000000000,18.7353000000000;1.98000000000000,19.3087000000000;2,19.8952000000000];
SquareMode1PLA=[0,0;0.0200000000000000,2.66165000000000e-05;0.0400000000000000,9.51430000000000e-05;0.0600000000000000,0.000200754000000000;0.0800000000000000,0.000342536000000000;0.100000000000000,0.000520591000000000;0.120000000000000,0.000735174000000000;0.140000000000000,0.000986537000000000;0.160000000000000,0.00127494000000000;0.180000000000000,0.00160070000000000;0.200000000000000,0.00196420000000000;0.220000000000000,0.00236591000000000;0.240000000000000,0.00280641000000000;0.260000000000000,0.00328634000000000;0.280000000000000,0.00380648000000000;0.300000000000000,0.00436766000000000;0.320000000000000,0.00497081000000000;0.340000000000000,0.00561693000000000;0.360000000000000,0.00630711000000000;0.380000000000000,0.00704248000000000;0.400000000000000,0.00782428000000000;0.420000000000000,0.00865377000000000;0.440000000000000,0.00953231000000000;0.460000000000000,0.0104613000000000;0.480000000000000,0.0114422000000000;0.500000000000000,0.0124764000000000;0.520000000000000,0.0135657000000000;0.540000000000000,0.0147115000000000;0.560000000000000,0.0159155000000000;0.580000000000000,0.0171795000000000;0.600000000000000,0.0185051000000000;0.620000000000000,0.0198942000000000;0.640000000000000,0.0213487000000000;0.660000000000000,0.0228703000000000;0.680000000000000,0.0244609000000000;0.700000000000000,0.0261227000000000;0.720000000000000,0.0278575000000000;0.740000000000000,0.0296673000000000;0.760000000000000,0.0315543000000000;0.780000000000000,0.0335206000000000;0.800000000000000,0.0355682000000000;0.820000000000000,0.0376994000000000;0.840000000000000,0.0399164000000000;0.860000000000000,0.0422214000000000;0.880000000000000,0.0446166000000000;0.900000000000000,0.0471045000000000;0.920000000000000,0.0496873000000000;0.940000000000000,0.0523674000000000;0.960000000000000,0.0551472000000000;0.980000000000000,0.0580291000000000;1,0.0610156000000000;1.02000000000000,0.0641092000000000;1.04000000000000,0.0673124000000000;1.06000000000000,0.0706277000000000;1.08000000000000,0.0740577000000000;1.10000000000000,0.0776050000000000;1.12000000000000,0.0812723000000000;1.14000000000000,0.0850621000000000;1.16000000000000,0.0889772000000000;1.18000000000000,0.0930202000000000;1.20000000000000,0.0971939000000000;1.22000000000000,0.101501000000000;1.24000000000000,0.105944000000000;1.26000000000000,0.110527000000000;1.28000000000000,0.115251000000000;1.30000000000000,0.120119000000000;1.32000000000000,0.125136000000000;1.34000000000000,0.130302000000000;1.36000000000000,0.135622000000000;1.38000000000000,0.141098000000000;1.40000000000000,0.146733000000000;1.42000000000000,0.152530000000000;1.44000000000000,0.158493000000000;1.46000000000000,0.164623000000000;1.48000000000000,0.170924000000000;1.50000000000000,0.177400000000000;1.52000000000000,0.184053000000000;1.54000000000000,0.190885000000000;1.56000000000000,0.197902000000000;1.58000000000000,0.205104000000000;1.60000000000000,0.212496000000000;1.62000000000000,0.220081000000000;1.64000000000000,0.227861000000000;1.66000000000000,0.235840000000000;1.68000000000000,0.244022000000000;1.70000000000000,0.252408000000000;1.72000000000000,0.261003000000000;1.74000000000000,0.269810000000000;1.76000000000000,0.278832000000000;1.78000000000000,0.288071000000000;1.80000000000000,0.297532000000000;1.82000000000000,0.307218000000000;1.84000000000000,0.317132000000000;1.86000000000000,0.327276000000000;1.88000000000000,0.337655000000000;1.90000000000000,0.348272000000000;1.92000000000000,0.359130000000000;1.94000000000000,0.370232000000000;1.96000000000000,0.381582000000000;1.98000000000000,0.393183000000000;2,0.405038000000000];

SquareMode1PLA(:,1)=2-abs(SquareMode1PLA(:,1));
figure(2)
hold on
plot(SquareMode1TPU(:,1),SquareMode1TPU(:,2),'r')
plot(SquareMode1PLA(:,1),SquareMode1PLA(:,2),'b')
plot(SquareMode1TPU(:,1),SquareMode1TPU(:,2)'+fliplr(SquareMode1PLA(:,2)'),'k')
a=SquareMode1TPU(:,1);
b=SquareMode1TPU(:,2)'+fliplr(SquareMode1PLA(:,2)');
plot(a(b==min(b)),min(b),'o')
a(b==min(b))
2-a(b==min(b))
xlabel('Ux [mm]')
ylabel('Strain Energe mJ')
legend('TPU','PLA','total energy','minimum point')
c=fliplr(SquareMode1PLA(:,2)');
d=SquareMode1TPU(:,2);
E_pla_80=c(b==min(b));
E_tpu_80=d(b==min(b));
E_pla_80_per=E_pla_80/(E_pla_80+E_tpu_80);
E_tpu_80_per=E_tpu_80/(E_pla_80+E_tpu_80);

figure(3)
hold on
axis([18 82 0 100])
plot([20,80],[E_pla_20_per,E_pla_80_per]*100,'^:','Color',[0 0.600000023841858 1],'LineWidth',1.5)
plot([20,80],[E_tpu_20_per,E_tpu_80_per]*100,'^:','Color',[1 0.800000011920929 0.200000002980232],'LineWidth',1.5)
xlabel('Temperature [^oC]')
ylabel('Energy [%]')
legend('PLA','TPU')

figure(4)
hold on
bar(1,E_pla_20+E_tpu_20,'b')
