clear
clc

SquareMode1TPU=[0,0;0.0200000000000000,0.00169064000000000;0.0400000000000000,0.00679198000000000;0.0600000000000000,0.0153503000000000;0.0800000000000000,0.0274149000000000;0.100000000000000,0.0430377000000000;0.120000000000000,0.0622741000000000;0.140000000000000,0.0851819000000000;0.160000000000000,0.111822000000000;0.180000000000000,0.142260000000000;0.200000000000000,0.176561000000000;0.220000000000000,0.214798000000000;0.240000000000000,0.257042000000000;0.260000000000000,0.303371000000000;0.280000000000000,0.353865000000000;0.300000000000000,0.408608000000000;0.320000000000000,0.467685000000000;0.340000000000000,0.531187000000000;0.360000000000000,0.599206000000000;0.380000000000000,0.671841000000000;0.400000000000000,0.749190000000000;0.420000000000000,0.831357000000000;0.440000000000000,0.918450000000000;0.460000000000000,1.01058000000000;0.480000000000000,1.10786000000000;0.500000000000000,1.21040000000000;0.520000000000000,1.31834000000000;0.540000000000000,1.43179000000000;0.560000000000000,1.55088000000000;0.580000000000000,1.67575000000000;0.600000000000000,1.80654000000000;0.620000000000000,1.94337000000000;0.640000000000000,2.08640000000000;0.660000000000000,2.23578000000000;0.680000000000000,2.39165000000000;0.700000000000000,2.55417000000000;0.720000000000000,2.72351000000000;0.740000000000000,2.89982000000000;0.760000000000000,3.08328000000000;0.780000000000000,3.27405000000000;0.800000000000000,3.47231000000000;0.820000000000000,3.67824000000000;0.840000000000000,3.89203000000000;0.860000000000000,4.11387000000000;0.880000000000000,4.34394000000000;0.900000000000000,4.58245000000000;0.920000000000000,4.82959000000000;0.940000000000000,5.08557000000000;0.960000000000000,5.35061000000000;0.980000000000000,5.62491000000000;1,5.90869000000000;1.02000000000000,6.20218000000000;1.04000000000000,6.50561000000000;1.06000000000000,6.81920000000000;1.08000000000000,7.14320000000000;1.10000000000000,7.47784000000000;1.12000000000000,7.82337000000000;1.14000000000000,8.18004000000000;1.16000000000000,8.54810000000000;1.18000000000000,8.92781000000000;1.20000000000000,9.31944000000000;1.22000000000000,9.72326000000000;1.24000000000000,10.1395000000000;1.26000000000000,10.5685000000000;1.28000000000000,11.0106000000000;1.30000000000000,11.4659000000000;1.32000000000000,11.9348000000000;1.34000000000000,12.4176000000000;1.36000000000000,12.9146000000000;1.38000000000000,13.4260000000000;1.40000000000000,13.9523000000000;1.42000000000000,14.4937000000000;1.44000000000000,15.0505000000000;1.46000000000000,15.6231000000000;1.48000000000000,16.2118000000000;1.50000000000000,16.8168000000000;1.52000000000000,17.4386000000000;1.54000000000000,18.0775000000000;1.56000000000000,18.7339000000000;1.58000000000000,19.4080000000000;1.60000000000000,20.1002000000000;1.62000000000000,20.8109000000000;1.64000000000000,21.5405000000000;1.66000000000000,22.2893000000000;1.68000000000000,23.0577000000000;1.70000000000000,23.8460000000000;1.72000000000000,24.6547000000000;1.74000000000000,25.4841000000000;1.76000000000000,26.3346000000000;1.78000000000000,27.2066000000000;1.80000000000000,28.1005000000000;1.82000000000000,29.0167000000000;1.84000000000000,29.9555000000000;1.86000000000000,30.9175000000000;1.88000000000000,31.9029000000000;1.90000000000000,32.9123000000000;1.92000000000000,33.9460000000000;1.94000000000000,35.0044000000000;1.96000000000000,36.0881000000000;1.98000000000000,37.1973000000000;2,38.3325000000000];
SquareMode1PLA=[0,0;0.0200000000000000,0.0121739000000000;0.0400000000000000,0.0488540000000000;0.0600000000000000,0.110309000000000;0.0800000000000000,0.196848000000000;0.100000000000000,0.308824000000000;0.120000000000000,0.446629000000000;0.140000000000000,0.610697000000000;0.160000000000000,0.801501000000000;0.180000000000000,1.01956000000000;0.200000000000000,1.26542000000000;0.220000000000000,1.53969000000000;0.240000000000000,1.84300000000000;0.260000000000000,2.17602000000000;0.280000000000000,2.53947000000000;0.300000000000000,2.93411000000000;0.320000000000000,3.36072000000000;0.340000000000000,3.82014000000000;0.360000000000000,4.31323000000000;0.380000000000000,4.84092000000000;0.400000000000000,5.40413000000000;0.420000000000000,6.00386000000000;0.440000000000000,6.64112000000000;0.460000000000000,7.31697000000000;0.480000000000000,8.03251000000000;0.500000000000000,8.78885000000000;0.520000000000000,9.58718000000000;0.540000000000000,10.4287000000000;0.560000000000000,11.3146000000000;0.580000000000000,12.2462000000000;0.600000000000000,13.2248000000000;0.620000000000000,14.2517000000000;0.640000000000000,15.3283000000000;0.660000000000000,16.4560000000000;0.680000000000000,17.6363000000000;0.700000000000000,18.8705000000000;0.720000000000000,20.1603000000000;0.740000000000000,21.5071000000000;0.760000000000000,22.9125000000000;0.780000000000000,24.3781000000000;0.800000000000000,25.9055000000000;0.820000000000000,27.4964000000000;0.840000000000000,29.1525000000000;0.860000000000000,30.8755000000000;0.880000000000000,32.6670000000000;0.900000000000000,34.5290000000000;0.920000000000000,36.4631000000000;0.940000000000000,38.4713000000000;0.960000000000000,40.5553000000000;0.980000000000000,42.7171000000000;1,44.9586000000000;1.02000000000000,47.2816000000000;1.04000000000000,49.6882000000000;1.06000000000000,52.1803000000000;1.08000000000000,54.7599000000000;1.10000000000000,57.4292000000000;1.12000000000000,60.1900000000000;1.14000000000000,63.0446000000000;1.16000000000000,65.9950000000000;1.18000000000000,69.0433000000000;1.20000000000000,72.1918000000000;1.22000000000000,75.4425000000000;1.24000000000000,78.7977000000000;1.26000000000000,82.2595000000000;1.28000000000000,85.8303000000000;1.30000000000000,89.5123000000000;1.32000000000000,93.3077000000000;1.34000000000000,97.2189000000000;1.36000000000000,101.248000000000;1.38000000000000,105.398000000000;1.40000000000000,109.670000000000;1.42000000000000,114.068000000000;1.44000000000000,118.593000000000;1.46000000000000,123.248000000000;1.48000000000000,128.036000000000;1.50000000000000,132.958000000000;1.52000000000000,138.018000000000;1.54000000000000,143.217000000000;1.56000000000000,148.559000000000;1.58000000000000,154.046000000000;1.60000000000000,159.680000000000;1.62000000000000,165.464000000000;1.64000000000000,171.400000000000;1.66000000000000,177.492000000000;1.68000000000000,183.741000000000;1.70000000000000,190.150000000000;1.72000000000000,196.723000000000;1.74000000000000,203.460000000000;1.76000000000000,210.367000000000;1.78000000000000,217.443000000000;1.80000000000000,224.694000000000;1.82000000000000,232.121000000000;1.84000000000000,239.726000000000;1.86000000000000,247.513000000000;1.88000000000000,255.485000000000;1.90000000000000,263.644000000000;1.92000000000000,271.993000000000;1.94000000000000,280.534000000000;1.96000000000000,289.271000000000;1.98000000000000,298.206000000000;2,307.342000000000];



SquareMode1PLA(:,1)=2-abs(SquareMode1PLA(:,1));
figure(1)
hold on
plot(SquareMode1TPU(:,1),SquareMode1TPU(:,2),'r')
plot(SquareMode1PLA(:,1),SquareMode1PLA(:,2),'b')
plot(SquareMode1TPU(:,1),SquareMode1TPU(:,2)'+fliplr(SquareMode1PLA(:,2)'),'k')
a=SquareMode1TPU(:,1);
b=SquareMode1TPU(:,2)'+fliplr(SquareMode1PLA(:,2)');
plot(a(b==min(b)),min(b),'o')
a(b==min(b))
2-a(b==min(b))
xlabel('Ux [mm]')
ylabel('Strain Energe mJ')
legend('TPU','PLA','total energy','minimum point')
c=fliplr(SquareMode1PLA(:,2)');
d=SquareMode1TPU(:,2);
E_pla_20=c(b==min(b));
E_tpu_20=d(b==min(b));
E_pla_20_per=E_pla_20/(E_pla_20+E_tpu_20);
E_tpu_20_per=E_tpu_20/(E_pla_20+E_tpu_20);


SquareMode1TPU=[0,0;0.0200000000000000,0.000492698000000000;0.0400000000000000,0.00197937000000000;0.0600000000000000,0.00447350000000000;0.0800000000000000,0.00798944000000000;0.100000000000000,0.0125424000000000;0.120000000000000,0.0181484000000000;0.140000000000000,0.0248243000000000;0.160000000000000,0.0325881000000000;0.180000000000000,0.0414584000000000;0.200000000000000,0.0514548000000000;0.220000000000000,0.0625979000000000;0.240000000000000,0.0749090000000000;0.260000000000000,0.0884106000000000;0.280000000000000,0.103126000000000;0.300000000000000,0.119079000000000;0.320000000000000,0.136296000000000;0.340000000000000,0.154802000000000;0.360000000000000,0.174625000000000;0.380000000000000,0.195793000000000;0.400000000000000,0.218334000000000;0.420000000000000,0.242280000000000;0.440000000000000,0.267661000000000;0.460000000000000,0.294510000000000;0.480000000000000,0.322860000000000;0.500000000000000,0.352745000000000;0.520000000000000,0.384200000000000;0.540000000000000,0.417263000000000;0.560000000000000,0.451970000000000;0.580000000000000,0.488361000000000;0.600000000000000,0.526474000000000;0.620000000000000,0.566352000000000;0.640000000000000,0.608035000000000;0.660000000000000,0.651567000000000;0.680000000000000,0.696992000000000;0.700000000000000,0.744356000000000;0.720000000000000,0.793705000000000;0.740000000000000,0.845087000000000;0.760000000000000,0.898551000000000;0.780000000000000,0.954147000000000;0.800000000000000,1.01193000000000;0.820000000000000,1.07194000000000;0.840000000000000,1.13425000000000;0.860000000000000,1.19889000000000;0.880000000000000,1.26594000000000;0.900000000000000,1.33545000000000;0.920000000000000,1.40747000000000;0.940000000000000,1.48207000000000;0.960000000000000,1.55931000000000;0.980000000000000,1.63925000000000;1,1.72195000000000;1.02000000000000,1.80749000000000;1.04000000000000,1.89591000000000;1.06000000000000,1.98730000000000;1.08000000000000,2.08172000000000;1.10000000000000,2.17925000000000;1.12000000000000,2.27994000000000;1.14000000000000,2.38389000000000;1.16000000000000,2.49115000000000;1.18000000000000,2.60181000000000;1.20000000000000,2.71594000000000;1.22000000000000,2.83362000000000;1.24000000000000,2.95494000000000;1.26000000000000,3.07996000000000;1.28000000000000,3.20878000000000;1.30000000000000,3.34147000000000;1.32000000000000,3.47812000000000;1.34000000000000,3.61882000000000;1.36000000000000,3.76366000000000;1.38000000000000,3.91272000000000;1.40000000000000,4.06609000000000;1.42000000000000,4.22386000000000;1.44000000000000,4.38614000000000;1.46000000000000,4.55300000000000;1.48000000000000,4.72455000000000;1.50000000000000,4.90088000000000;1.52000000000000,5.08209000000000;1.54000000000000,5.26828000000000;1.56000000000000,5.45956000000000;1.58000000000000,5.65601000000000;1.60000000000000,5.85775000000000;1.62000000000000,6.06487000000000;1.64000000000000,6.27749000000000;1.66000000000000,6.49571000000000;1.68000000000000,6.71964000000000;1.70000000000000,6.94938000000000;1.72000000000000,7.18505000000000;1.74000000000000,7.42676000000000;1.76000000000000,7.67462000000000;1.78000000000000,7.92875000000000;1.80000000000000,8.18925000000000;1.82000000000000,8.45625000000000;1.84000000000000,8.72986000000000;1.86000000000000,9.01020000000000;1.88000000000000,9.29739000000000;1.90000000000000,9.59155000000000;1.92000000000000,9.89279000000000;1.94000000000000,10.2013000000000;1.96000000000000,10.5170000000000;1.98000000000000,10.8403000000000;2,11.1711000000000];
SquareMode1PLA=[0,0;0.0200000000000000,1.76539000000000e-05;0.0400000000000000,6.30970000000000e-05;0.0600000000000000,0.000133118000000000;0.0800000000000000,0.000227099000000000;0.100000000000000,0.000345095000000000;0.120000000000000,0.000487260000000000;0.140000000000000,0.000653747000000000;0.160000000000000,0.000844714000000000;0.180000000000000,0.00106035000000000;0.200000000000000,0.00130088000000000;0.220000000000000,0.00156662000000000;0.240000000000000,0.00185791000000000;0.260000000000000,0.00217518000000000;0.280000000000000,0.00251889000000000;0.300000000000000,0.00288958000000000;0.320000000000000,0.00328785000000000;0.340000000000000,0.00371433000000000;0.360000000000000,0.00416971000000000;0.380000000000000,0.00465473000000000;0.400000000000000,0.00517015000000000;0.420000000000000,0.00571681000000000;0.440000000000000,0.00629556000000000;0.460000000000000,0.00690729000000000;0.480000000000000,0.00755294000000000;0.500000000000000,0.00823348000000000;0.520000000000000,0.00894989000000000;0.540000000000000,0.00970322000000000;0.560000000000000,0.0104945000000000;0.580000000000000,0.0113249000000000;0.600000000000000,0.0121955000000000;0.620000000000000,0.0131073000000000;0.640000000000000,0.0140618000000000;0.660000000000000,0.0150599000000000;0.680000000000000,0.0161029000000000;0.700000000000000,0.0171922000000000;0.720000000000000,0.0183289000000000;0.740000000000000,0.0195145000000000;0.760000000000000,0.0207501000000000;0.780000000000000,0.0220372000000000;0.800000000000000,0.0233771000000000;0.820000000000000,0.0247713000000000;0.840000000000000,0.0262210000000000;0.860000000000000,0.0277279000000000;0.880000000000000,0.0292933000000000;0.900000000000000,0.0309188000000000;0.920000000000000,0.0326057000000000;0.940000000000000,0.0343557000000000;0.960000000000000,0.0361703000000000;0.980000000000000,0.0380511000000000;1,0.0399995000000000;1.02000000000000,0.0420173000000000;1.04000000000000,0.0441060000000000;1.06000000000000,0.0462673000000000;1.08000000000000,0.0485028000000000;1.10000000000000,0.0508142000000000;1.12000000000000,0.0532032000000000;1.14000000000000,0.0556714000000000;1.16000000000000,0.0582206000000000;1.18000000000000,0.0608526000000000;1.20000000000000,0.0635690000000000;1.22000000000000,0.0663717000000000;1.24000000000000,0.0692624000000000;1.26000000000000,0.0722429000000000;1.28000000000000,0.0753150000000000;1.30000000000000,0.0784806000000000;1.32000000000000,0.0817414000000000;1.34000000000000,0.0850994000000000;1.36000000000000,0.0885563000000000;1.38000000000000,0.0921141000000000;1.40000000000000,0.0957747000000000;1.42000000000000,0.0995400000000000;1.44000000000000,0.103412000000000;1.46000000000000,0.107392000000000;1.48000000000000,0.111483000000000;1.50000000000000,0.115686000000000;1.52000000000000,0.120003000000000;1.54000000000000,0.124437000000000;1.56000000000000,0.128989000000000;1.58000000000000,0.133661000000000;1.60000000000000,0.138456000000000;1.62000000000000,0.143375000000000;1.64000000000000,0.148420000000000;1.66000000000000,0.153594000000000;1.68000000000000,0.158898000000000;1.70000000000000,0.164334000000000;1.72000000000000,0.169905000000000;1.74000000000000,0.175612000000000;1.76000000000000,0.181458000000000;1.78000000000000,0.187444000000000;1.80000000000000,0.193574000000000;1.82000000000000,0.199848000000000;1.84000000000000,0.206269000000000;1.86000000000000,0.212840000000000;1.88000000000000,0.219561000000000;1.90000000000000,0.226436000000000;1.92000000000000,0.233466000000000;1.94000000000000,0.240654000000000;1.96000000000000,0.248001000000000;1.98000000000000,0.255511000000000;2,0.263184000000000];


SquareMode1PLA(:,1)=2-abs(SquareMode1PLA(:,1));
figure(2)
hold on
plot(SquareMode1TPU(:,1),SquareMode1TPU(:,2),'r')
plot(SquareMode1PLA(:,1),SquareMode1PLA(:,2),'b')
plot(SquareMode1TPU(:,1),SquareMode1TPU(:,2)'+fliplr(SquareMode1PLA(:,2)'),'k')
a=SquareMode1TPU(:,1);
b=SquareMode1TPU(:,2)'+fliplr(SquareMode1PLA(:,2)');
plot(a(b==min(b)),min(b),'o')
a(b==min(b))
2-a(b==min(b))
xlabel('Ux [mm]')
ylabel('Strain Energe mJ')
legend('TPU','PLA','total energy','minimum point')
c=fliplr(SquareMode1PLA(:,2)');
d=SquareMode1TPU(:,2);
E_pla_80=c(b==min(b));
E_tpu_80=d(b==min(b));
E_pla_80_per=E_pla_80/(E_pla_80+E_tpu_80);
E_tpu_80_per=E_tpu_80/(E_pla_80+E_tpu_80);

figure(3)
hold on
plot([20,80],[E_pla_20_per,E_pla_80_per]*100,'s:','Color',[0 0.600000023841858 1],'LineWidth',1.5)
plot([20,80],[E_tpu_20_per,E_tpu_80_per]*100,'s:','Color',[1 0.800000011920929 0.200000002980232],'LineWidth',1.5)
xlabel('Temperature [^oC]')
ylabel('Energy [%]')
legend('PLA','TPU')

figure(4)
hold on
bar(3,E_pla_20+E_tpu_20,'b')
