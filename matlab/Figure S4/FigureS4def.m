clear
clc

%% Our Proposed design - TPU (Dt=4mm)
Dt0=4;
lt0=40;
r0=3;
E_tpu=90;
h=5;
b=2;
b_p=2; %The thickness of PLA beam
I=h*b^3/12;
EI_tpu=E_tpu*I;
M=0.001:0.01:50;

alpha0=atan(2*Dt0/lt0);
l1=lt0/2/cos(alpha0)-r0-b/2;
% l1=lt0/2/cos(alpha0)-r0;
beta0=pi-2*alpha0;
s0=beta0*r0;
r=1./(M/EI_tpu+1/r0);
s=s0;
beta=s./r;
alpha=(pi-beta)/2;
DELTA=M*(l1)^2/3/EI_tpu;
Dt=(l1+r+b/2).*sin(alpha)-DELTA.*cos(alpha);
%Dt=(l1+r).*sin(alpha)-DELTA.*cos(alpha);
lt=lt0+2.*DELTA.*sin(alpha);
Dt_a=Dt(Dt>-1)+b/2;
lt_a=lt(Dt>-1);


figure(1)
hold on
plot3(Dt_a,Dt_a*0+20,lt_a,'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3(Dt_a,Dt_a*0+80,lt_a,'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])

n=1:20:101;
concave_40_4_3=[0,0;-0.0500000000000000,0.0159991000000000;-0.100000000000000,0.0316875000000000;-0.150000000000000,0.0470657000000000;-0.200000000000000,0.0621342000000000;-0.250000000000000,0.0768934000000000;-0.300000000000000,0.0913437000000000;-0.350000000000000,0.105486000000000;-0.400000000000000,0.119319000000000;-0.450000000000000,0.132846000000000;-0.500000000000000,0.146064000000000;-0.550000000000000,0.158976000000000;-0.600000000000000,0.171582000000000;-0.650000000000000,0.183881000000000;-0.700000000000000,0.195875000000000;-0.750000000000000,0.207563000000000;-0.800000000000000,0.218946000000000;-0.850000000000000,0.230024000000000;-0.900000000000000,0.240798000000000;-0.950000000000000,0.251267000000000;-1,0.261433000000000;-1.05000000000000,0.271295000000000;-1.10000000000000,0.280854000000000;-1.15000000000000,0.290110000000000;-1.20000000000000,0.299063000000000;-1.25000000000000,0.307714000000000;-1.30000000000000,0.316063000000000;-1.35000000000000,0.324109000000000;-1.40000000000000,0.331854000000000;-1.45000000000000,0.339298000000000;-1.50000000000000,0.346440000000000;-1.55000000000000,0.353281000000000;-1.60000000000000,0.359822000000000;-1.65000000000000,0.366062000000000;-1.70000000000000,0.372001000000000;-1.75000000000000,0.377640000000000;-1.80000000000000,0.382979000000000;-1.85000000000000,0.388019000000000;-1.90000000000000,0.392758000000000;-1.95000000000000,0.397198000000000;-2,0.401338000000000;-2.05000000000000,0.405180000000000;-2.10000000000000,0.408722000000000;-2.15000000000000,0.411965000000000;-2.20000000000000,0.414909000000000;-2.25000000000000,0.417554000000000;-2.30000000000000,0.419901000000000;-2.35000000000000,0.421949000000000;-2.40000000000000,0.423698000000000;-2.45000000000000,0.425149000000000;-2.50000000000000,0.426301000000000;-2.55000000000000,0.427156000000000;-2.60000000000000,0.427712000000000;-2.65000000000000,0.427969000000000;-2.70000000000000,0.427929000000000;-2.75000000000000,0.427590000000000;-2.80000000000000,0.426954000000000;-2.85000000000000,0.426019000000000;-2.90000000000000,0.424786000000000;-2.95000000000000,0.423255000000000;-3,0.421426000000000;-3.05000000000000,0.419299000000000;-3.10000000000000,0.416874000000000;-3.15000000000000,0.414150000000000;-3.20000000000000,0.411128000000000;-3.25000000000000,0.407809000000000;-3.30000000000000,0.404190000000000;-3.35000000000000,0.400274000000000;-3.40000000000000,0.396059000000000;-3.45000000000000,0.391546000000000;-3.50000000000000,0.386734000000000;-3.55000000000000,0.381623000000000;-3.60000000000000,0.376214000000000;-3.65000000000000,0.370505000000000;-3.70000000000000,0.364498000000000;-3.75000000000000,0.358192000000000;-3.80000000000000,0.351587000000000;-3.85000000000000,0.344682000000000;-3.90000000000000,0.337478000000000;-3.95000000000000,0.329974000000000;-4,0.322171000000000;-4.05000000000000,0.314067000000000;-4.10000000000000,0.305663000000000;-4.15000000000000,0.296960000000000;-4.20000000000000,0.287955000000000;-4.25000000000000,0.278650000000000;-4.30000000000000,0.269044000000000;-4.35000000000000,0.259137000000000;-4.40000000000000,0.248929000000000;-4.45000000000000,0.238419000000000;-4.50000000000000,0.227608000000000;-4.55000000000000,0.216494000000000;-4.60000000000000,0.205079000000000;-4.65000000000000,0.193360000000000;-4.70000000000000,0.181339000000000;-4.75000000000000,0.169015000000000;-4.80000000000000,0.156388000000000;-4.85000000000000,0.143457000000000;-4.90000000000000,0.130222000000000;-4.95000000000000,0.116683000000000;-5,0.102839000000000];
Dt_s=Dt0+b_p/2+concave_40_4_3(:,1);
Dt_s=Dt_s';
lt_s=lt0+concave_40_4_3(:,2);
lt_s=lt_s';
plot3(Dt_s(n),Dt_s(n)*0+20,lt_s(n),':^','LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3(Dt_s(n),Dt_s(n)*0+80,lt_s(n),':^','LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])


%% Our proposed design - PLA

lp0=lt_a(end);
E_pla=7;
b=2;h=5;
I=h*b^3/12;
EI_pla=E_pla*I;
Dp_a=0:0.01:Dt0+b/2;
lp_a=lp0-12*Dp_a.^2/5/lp0;

PLA=[0,0;0.0500000000000000,-0.000143303000000000;0.100000000000000,-0.000582921000000000;0.150000000000000,-0.00131886000000000;0.200000000000000,-0.00235113000000000;0.250000000000000,-0.00367975000000000;0.300000000000000,-0.00530474000000000;0.350000000000000,-0.00722614000000000;0.400000000000000,-0.00944399000000000;0.450000000000000,-0.0119583000000000;0.500000000000000,-0.0147692000000000;0.550000000000000,-0.0178768000000000;0.600000000000000,-0.0212810000000000;0.650000000000000,-0.0249819000000000;0.700000000000000,-0.0289797000000000;0.750000000000000,-0.0332745000000000;0.800000000000000,-0.0378663000000000;0.850000000000000,-0.0427552000000000;0.900000000000000,-0.0479414000000000;0.950000000000000,-0.0534250000000000;1,-0.0592061000000000;1.05000000000000,-0.0652849000000000;1.10000000000000,-0.0716614000000000;1.15000000000000,-0.0783359000000000;1.20000000000000,-0.0853085000000000;1.25000000000000,-0.0925794000000000;1.30000000000000,-0.100149000000000;1.35000000000000,-0.108017000000000;1.40000000000000,-0.116183000000000;1.45000000000000,-0.124649000000000;1.50000000000000,-0.133414000000000;1.55000000000000,-0.142479000000000;1.60000000000000,-0.151843000000000;1.65000000000000,-0.161507000000000;1.70000000000000,-0.171471000000000;1.75000000000000,-0.181735000000000;1.80000000000000,-0.192300000000000;1.85000000000000,-0.203166000000000;1.90000000000000,-0.214333000000000;1.95000000000000,-0.225802000000000;2,-0.237572000000000;2.05000000000000,-0.249644000000000;2.10000000000000,-0.262019000000000;2.15000000000000,-0.274696000000000;2.20000000000000,-0.287676000000000;2.25000000000000,-0.300959000000000;2.30000000000000,-0.314546000000000;2.35000000000000,-0.328436000000000;2.40000000000000,-0.342631000000000;2.45000000000000,-0.357131000000000;2.50000000000000,-0.371935000000000;2.55000000000000,-0.387045000000000;2.60000000000000,-0.402461000000000;2.65000000000000,-0.418182000000000;2.70000000000000,-0.434210000000000;2.75000000000000,-0.450546000000000;2.80000000000000,-0.467188000000000;2.85000000000000,-0.484138000000000;2.90000000000000,-0.501396000000000;2.95000000000000,-0.518963000000000;3,-0.536839000000000;3.05000000000000,-0.555025000000000;3.10000000000000,-0.573520000000000;3.15000000000000,-0.592327000000000;3.20000000000000,-0.611444000000000;3.25000000000000,-0.630872000000000;3.30000000000000,-0.650612000000000;3.35000000000000,-0.670665000000000;3.40000000000000,-0.691031000000000;3.45000000000000,-0.711710000000000;3.50000000000000,-0.732704000000000;3.55000000000000,-0.754012000000000;3.60000000000000,-0.775635000000000;3.65000000000000,-0.797574000000000;3.70000000000000,-0.819829000000000;3.75000000000000,-0.842401000000000;3.80000000000000,-0.865291000000000;3.85000000000000,-0.888499000000000;3.90000000000000,-0.912025000000000;3.95000000000000,-0.935871000000000;4,-0.960037000000000;4.05000000000000,-0.984523000000000;4.10000000000000,-1.00933000000000;4.15000000000000,-1.03446000000000;4.20000000000000,-1.05991000000000;4.25000000000000,-1.08569000000000;4.30000000000000,-1.11179000000000;4.35000000000000,-1.13821000000000;4.40000000000000,-1.16496000000000;4.45000000000000,-1.19204000000000;4.50000000000000,-1.21944000000000;4.55000000000000,-1.24717000000000;4.60000000000000,-1.27523000000000;4.65000000000000,-1.30362000000000;4.70000000000000,-1.33234000000000;4.75000000000000,-1.36139000000000;4.80000000000000,-1.39077000000000;4.85000000000000,-1.42048000000000;4.90000000000000,-1.45053000000000;4.95000000000000,-1.48091000000000;5,-1.51163000000000];
Dp_s=PLA(:,1);
lp_s=lp0+PLA(:,2);

figure(1)
plot3(Dp_a,Dp_a*0+80,lp_a,'LineWidth',1.5,'Color',[0 0.600000023841858 1])
plot3(Dp_s(n),Dp_s(n)*0+80,lp_s(n),':^','LineWidth',1.5,'Color',[0 0.600000023841858 1])

plot3([Dt_a(end),Dt_a(end)],[20,80],[lt_a(end),lt_a(end)],'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3([Dt_a(end),Dt_a(end)],[20,80],[lt_a(end),lt_a(end)],'--','LineWidth',1.5,'Color',[0 0.600000023841858 1])

xlabel('Height D [mm]')
ylabel('Temperature [^oC]')
zlabel('Length l [mm]')

axis([0 5 20 80 38 47])
view([45 30])
box on
% legend('TPU beam (analytical model)','TPU beam (FE simulation)','PLA beam (analytical model)','PLA beam (FE simulation)')

lp0
Gap=abs(lp_a(end)-lt0)


%% Circle - TPU (Dt0=5mm£¬D=5mm)
Dt0=5;
bt=2;
lt0=40;
r0=((Dt0).^2+lt0.^2/4)./2./(Dt0);
alpha0=2*asin(lt0./2./r0);
s0=alpha0.*r0;
s=s0;
alpha=0.001:0.001:alpha0;
r=s./alpha;
D=r-r.*cos(alpha/2);
lt=2.*r.*sin(alpha/2);
figure(2)
plot3(D,D*0+20,lt,'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
hold on
plot3(D,D*0+80,lt,'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])

n=1:20:101;
Circle=[0,0;-0.0500000000000000,0.0314552000000000;-0.100000000000000,0.0625781000000000;-0.150000000000000,0.0933697000000000;-0.200000000000000,0.123831000000000;-0.250000000000000,0.153962000000000;-0.300000000000000,0.183765000000000;-0.350000000000000,0.213239000000000;-0.400000000000000,0.242387000000000;-0.450000000000000,0.271208000000000;-0.500000000000000,0.299703000000000;-0.550000000000000,0.327874000000000;-0.600000000000000,0.355720000000000;-0.650000000000000,0.383244000000000;-0.700000000000000,0.410445000000000;-0.750000000000000,0.437324000000000;-0.800000000000000,0.463883000000000;-0.850000000000000,0.490121000000000;-0.900000000000000,0.516039000000000;-0.950000000000000,0.541639000000000;-1,0.566920000000000;-1.05000000000000,0.591884000000000;-1.10000000000000,0.616532000000000;-1.15000000000000,0.640863000000000;-1.20000000000000,0.664878000000000;-1.25000000000000,0.688579000000000;-1.30000000000000,0.711966000000000;-1.35000000000000,0.735039000000000;-1.40000000000000,0.757798000000000;-1.45000000000000,0.780246000000000;-1.50000000000000,0.802382000000000;-1.55000000000000,0.824206000000000;-1.60000000000000,0.845720000000000;-1.65000000000000,0.866924000000000;-1.70000000000000,0.887819000000000;-1.75000000000000,0.908404000000000;-1.80000000000000,0.928681000000000;-1.85000000000000,0.948650000000000;-1.90000000000000,0.968312000000000;-1.95000000000000,0.987667000000000;-2,1.00672000000000;-2.05000000000000,1.02546000000000;-2.10000000000000,1.04390000000000;-2.15000000000000,1.06203000000000;-2.20000000000000,1.07986000000000;-2.25000000000000,1.09738000000000;-2.30000000000000,1.11460000000000;-2.35000000000000,1.13152000000000;-2.40000000000000,1.14813000000000;-2.45000000000000,1.16445000000000;-2.50000000000000,1.18046000000000;-2.55000000000000,1.19617000000000;-2.60000000000000,1.21157000000000;-2.65000000000000,1.22668000000000;-2.70000000000000,1.24149000000000;-2.75000000000000,1.25600000000000;-2.80000000000000,1.27020000000000;-2.85000000000000,1.28411000000000;-2.90000000000000,1.29772000000000;-2.95000000000000,1.31104000000000;-3,1.32405000000000;-3.05000000000000,1.33677000000000;-3.10000000000000,1.34918000000000;-3.15000000000000,1.36131000000000;-3.20000000000000,1.37313000000000;-3.25000000000000,1.38466000000000;-3.30000000000000,1.39589000000000;-3.35000000000000,1.40683000000000;-3.40000000000000,1.41747000000000;-3.45000000000000,1.42781000000000;-3.50000000000000,1.43786000000000;-3.55000000000000,1.44762000000000;-3.60000000000000,1.45708000000000;-3.65000000000000,1.46624000000000;-3.70000000000000,1.47512000000000;-3.75000000000000,1.48369000000000;-3.80000000000000,1.49198000000000;-3.85000000000000,1.49997000000000;-3.90000000000000,1.50767000000000;-3.95000000000000,1.51507000000000;-4,1.52218000000000;-4.05000000000000,1.52900000000000;-4.10000000000000,1.53553000000000;-4.15000000000000,1.54176000000000;-4.20000000000000,1.54770000000000;-4.25000000000000,1.55335000000000;-4.30000000000000,1.55871000000000;-4.35000000000000,1.56377000000000;-4.40000000000000,1.56855000000000;-4.45000000000000,1.57303000000000;-4.50000000000000,1.57722000000000;-4.55000000000000,1.58112000000000;-4.60000000000000,1.58473000000000;-4.65000000000000,1.58804000000000;-4.70000000000000,1.59107000000000;-4.75000000000000,1.59380000000000;-4.80000000000000,1.59625000000000;-4.85000000000000,1.59840000000000;-4.90000000000000,1.60026000000000;-4.95000000000000,1.60184000000000;-5,1.60312000000000];
Dt_s=Dt0+Circle(:,1);
Dt_s=Dt_s';
lt_s=lt0+Circle(:,2);
lt_s=lt_s';
plot3(Dt_s(n),Dt_s(n)*0+20,lt_s(n),':^','LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3(Dt_s(n),Dt_s(n)*0+80,lt_s(n),':^','LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])


%% Circle - PLA (Dt0=5mm£¬D=5mm)
lp0=lt(1);
E_pla=7;
b=2;h=5;
I=h*b^3/12;
EI_pla=E_pla*I;
Dp_a=0:0.01:Dt0+b/2;
lp_a=lp0-12*Dp_a.^2/5/lp0;
plot3(Dp_a,Dp_a*0+80,lp_a,'LineWidth',1.5,'Color',[0 0.600000023841858 1])

lp0=lt(1);
Circle_PLA=[0,0;0.0500000000000000,-0.000139346000000000;0.100000000000000,-0.000566248000000000;0.150000000000000,-0.00128071000000000;0.200000000000000,-0.00228274000000000;0.250000000000000,-0.00357237000000000;0.300000000000000,-0.00514960000000000;0.350000000000000,-0.00701448000000000;0.400000000000000,-0.00916704000000000;0.450000000000000,-0.0116073000000000;0.500000000000000,-0.0143354000000000;0.550000000000000,-0.0173513000000000;0.600000000000000,-0.0206551000000000;0.650000000000000,-0.0242468000000000;0.700000000000000,-0.0281266000000000;0.750000000000000,-0.0322946000000000;0.800000000000000,-0.0367507000000000;0.850000000000000,-0.0414952000000000;0.900000000000000,-0.0465281000000000;0.950000000000000,-0.0518496000000000;1,-0.0574597000000000;1.05000000000000,-0.0633586000000000;1.10000000000000,-0.0695463000000000;1.15000000000000,-0.0760232000000000;1.20000000000000,-0.0827893000000000;1.25000000000000,-0.0898447000000000;1.30000000000000,-0.0971896000000000;1.35000000000000,-0.104824000000000;1.40000000000000,-0.112749000000000;1.45000000000000,-0.120963000000000;1.50000000000000,-0.129468000000000;1.55000000000000,-0.138263000000000;1.60000000000000,-0.147349000000000;1.65000000000000,-0.156725000000000;1.70000000000000,-0.166393000000000;1.75000000000000,-0.176352000000000;1.80000000000000,-0.186602000000000;1.85000000000000,-0.197144000000000;1.90000000000000,-0.207978000000000;1.95000000000000,-0.219104000000000;2,-0.230523000000000;2.05000000000000,-0.242235000000000;2.10000000000000,-0.254239000000000;2.15000000000000,-0.266537000000000;2.20000000000000,-0.279129000000000;2.25000000000000,-0.292014000000000;2.30000000000000,-0.305193000000000;2.35000000000000,-0.318667000000000;2.40000000000000,-0.332436000000000;2.45000000000000,-0.346500000000000;2.50000000000000,-0.360860000000000;2.55000000000000,-0.375515000000000;2.60000000000000,-0.390466000000000;2.65000000000000,-0.405714000000000;2.70000000000000,-0.421259000000000;2.75000000000000,-0.437101000000000;2.80000000000000,-0.453241000000000;2.85000000000000,-0.469679000000000;2.90000000000000,-0.486415000000000;2.95000000000000,-0.503450000000000;3,-0.520784000000000;3.05000000000000,-0.538418000000000;3.10000000000000,-0.556351000000000;3.15000000000000,-0.574586000000000;3.20000000000000,-0.593121000000000;3.25000000000000,-0.611958000000000;3.30000000000000,-0.631096000000000;3.35000000000000,-0.650537000000000;3.40000000000000,-0.670281000000000;3.45000000000000,-0.690327000000000;3.50000000000000,-0.710678000000000;3.55000000000000,-0.731333000000000;3.60000000000000,-0.752293000000000;3.65000000000000,-0.773558000000000;3.70000000000000,-0.795128000000000;3.75000000000000,-0.817006000000000;3.80000000000000,-0.839190000000000;3.85000000000000,-0.861681000000000;3.90000000000000,-0.884481000000000;3.95000000000000,-0.907589000000000;4,-0.931006000000000;4.05000000000000,-0.954733000000000;4.10000000000000,-0.978770000000000;4.15000000000000,-1.00312000000000;4.20000000000000,-1.02778000000000;4.25000000000000,-1.05275000000000;4.30000000000000,-1.07804000000000;4.35000000000000,-1.10363000000000;4.40000000000000,-1.12955000000000;4.45000000000000,-1.15577000000000;4.50000000000000,-1.18232000000000;4.55000000000000,-1.20918000000000;4.60000000000000,-1.23635000000000;4.65000000000000,-1.26384000000000;4.70000000000000,-1.29166000000000;4.75000000000000,-1.31979000000000;4.80000000000000,-1.34824000000000;4.85000000000000,-1.37701000000000;4.90000000000000,-1.40610000000000;4.95000000000000,-1.43551000000000;5,-1.46525000000000];
Dp_s=Circle_PLA(:,1);
lp_s=lp0+Circle_PLA(:,2);
figure(2)
plot3(Dp_s(n),Dp_s(n)*0+80,lp_s(n),':^','LineWidth',1.5,'Color',[0 0.600000023841858 1])

plot3([D(1),D(1)],[20,80],[lt(1),lt(1)],'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3([D(1),D(1)],[20,80],[lt(1),lt(1)],'--','LineWidth',1.5,'Color',[0 0.600000023841858 1])

xlabel('Height D [mm]')
ylabel('Temperature [^oC]')
zlabel('Length l [mm]')

axis([0 5 20 80 38 47])
view([45 30])
box on
% legend('TPU beam (analytical model)','TPU beam (FE simulation)','PLA beam (analytical model)','PLA beam (FE simulation)')


%% Triangular - TPU (Dt0=10mm,D=5mm)

l0=40; %Initial length of the curved beam
delta0=15; %The largest initial displacement
E=130; %Young's modulus of TPU in low temperature
b=5;h=2;
I=b*h^3/12;
EI=E*I;
a=((l0/2)^2+delta0^2)^0.5;
theta=atan(2*delta0/l0);
F=0:0.01:2;
k=0.5*delta0;
w_max=k*F*a^2/(2*EI);
l_hinge=pi*h/2;
theta1=theta-l_hinge*k*F/2/EI;
l=l0+2*w_max.*sin(theta1)-k^2.*F.^2*a^3/(6*EI^2).*cos(theta1);
d=w_max.*cos(theta1);
Dt_a=5-d;
lt_a=l;
Dt_a=Dt_a(Dt_a>0);
lt_a=lt_a(Dt_a>0);
figure(3)
plot3(Dt_a,Dt_a*0+20,lt_a,'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
hold on
plot3(Dt_a,Dt_a*0+80,lt_a,'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])

n=1:20:101;
Triangular=[0,0;-0.0500000000000000,0.0741101000000000;-0.100000000000000,0.147746000000000;-0.150000000000000,0.220910000000000;-0.200000000000000,0.293605000000000;-0.250000000000000,0.365835000000000;-0.300000000000000,0.437602000000000;-0.350000000000000,0.508910000000000;-0.400000000000000,0.579761000000000;-0.450000000000000,0.650158000000000;-0.500000000000000,0.720104000000000;-0.550000000000000,0.789601000000000;-0.600000000000000,0.858653000000000;-0.650000000000000,0.927261000000000;-0.700000000000000,0.995430000000000;-0.750000000000000,1.06316000000000;-0.800000000000000,1.13046000000000;-0.850000000000000,1.19732000000000;-0.900000000000000,1.26375000000000;-0.950000000000000,1.32975000000000;-1,1.39533000000000;-1.05000000000000,1.46049000000000;-1.10000000000000,1.52522000000000;-1.15000000000000,1.58954000000000;-1.20000000000000,1.65344000000000;-1.25000000000000,1.71693000000000;-1.30000000000000,1.78000000000000;-1.35000000000000,1.84267000000000;-1.40000000000000,1.90493000000000;-1.45000000000000,1.96678000000000;-1.50000000000000,2.02824000000000;-1.55000000000000,2.08929000000000;-1.60000000000000,2.14994000000000;-1.65000000000000,2.21019000000000;-1.70000000000000,2.27006000000000;-1.75000000000000,2.32952000000000;-1.80000000000000,2.38860000000000;-1.85000000000000,2.44729000000000;-1.90000000000000,2.50559000000000;-1.95000000000000,2.56351000000000;-2,2.62104000000000;-2.05000000000000,2.67819000000000;-2.10000000000000,2.73497000000000;-2.15000000000000,2.79136000000000;-2.20000000000000,2.84738000000000;-2.25000000000000,2.90303000000000;-2.30000000000000,2.95830000000000;-2.35000000000000,3.01320000000000;-2.40000000000000,3.06774000000000;-2.45000000000000,3.12190000000000;-2.50000000000000,3.17570000000000;-2.55000000000000,3.22914000000000;-2.60000000000000,3.28221000000000;-2.65000000000000,3.33493000000000;-2.70000000000000,3.38728000000000;-2.75000000000000,3.43927000000000;-2.80000000000000,3.49091000000000;-2.85000000000000,3.54220000000000;-2.90000000000000,3.59313000000000;-2.95000000000000,3.64371000000000;-3,3.69394000000000;-3.05000000000000,3.74382000000000;-3.10000000000000,3.79335000000000;-3.15000000000000,3.84254000000000;-3.20000000000000,3.89138000000000;-3.25000000000000,3.93988000000000;-3.30000000000000,3.98804000000000;-3.35000000000000,4.03586000000000;-3.40000000000000,4.08333000000000;-3.45000000000000,4.13047000000000;-3.50000000000000,4.17727000000000;-3.55000000000000,4.22374000000000;-3.60000000000000,4.26987000000000;-3.65000000000000,4.31567000000000;-3.70000000000000,4.36114000000000;-3.75000000000000,4.40628000000000;-3.80000000000000,4.45109000000000;-3.85000000000000,4.49557000000000;-3.90000000000000,4.53972000000000;-3.95000000000000,4.58355000000000;-4,4.62705000000000;-4.05000000000000,4.67023000000000;-4.10000000000000,4.71309000000000;-4.15000000000000,4.75562000000000;-4.20000000000000,4.79784000000000;-4.25000000000000,4.83973000000000;-4.30000000000000,4.88131000000000;-4.35000000000000,4.92257000000000;-4.40000000000000,4.96352000000000;-4.45000000000000,5.00415000000000;-4.50000000000000,5.04447000000000;-4.55000000000000,5.08447000000000;-4.60000000000000,5.12416000000000;-4.65000000000000,5.16354000000000;-4.70000000000000,5.20261000000000;-4.75000000000000,5.24138000000000;-4.80000000000000,5.27983000000000;-4.85000000000000,5.31798000000000;-4.90000000000000,5.35582000000000;-4.95000000000000,5.39335000000000;-5,5.43058000000000];
Dt_s=Dt0+Triangular(:,1);
Dt_s=Dt_s';
lt_s=lt0+Triangular(:,2);
lt_s=lt_s';
plot3(Dt_s(n),Dt_s(n)*0+20,lt_s(n),':^','LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3(Dt_s(n),Dt_s(n)*0+80,lt_s(n),':^','LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])


%% Triangular - PLA (Dt0=10mm,D=5mm)

lp0=lt_a(end);
E_pla=7;
b=2;h=5;
I=h*b^3/12;
EI_pla=E_pla*I;
Dp_a=0:0.01:Dt0+b/2;
lp_a=lp0-12*Dp_a.^2/5/lp0;
plot3(Dp_a,Dp_a*0+80,lp_a,'LineWidth',1.5,'Color',[0 0.600000023841858 1])

lp0=lt_a(end);
Triangular_PLA=[0,0;0.0500000000000000,-0.000126416000000000;0.100000000000000,-0.000512147000000000;0.150000000000000,-0.00115719000000000;0.200000000000000,-0.00206157000000000;0.250000000000000,-0.00322528000000000;0.300000000000000,-0.00464835000000000;0.350000000000000,-0.00633080000000000;0.400000000000000,-0.00827265000000000;0.450000000000000,-0.0104740000000000;0.500000000000000,-0.0129347000000000;0.550000000000000,-0.0156550000000000;0.600000000000000,-0.0186349000000000;0.650000000000000,-0.0218744000000000;0.700000000000000,-0.0253736000000000;0.750000000000000,-0.0291325000000000;0.800000000000000,-0.0331512000000000;0.850000000000000,-0.0374298000000000;0.900000000000000,-0.0419684000000000;0.950000000000000,-0.0467670000000000;1,-0.0518258000000000;1.05000000000000,-0.0571447000000000;1.10000000000000,-0.0627240000000000;1.15000000000000,-0.0685638000000000;1.20000000000000,-0.0746640000000000;1.25000000000000,-0.0810249000000000;1.30000000000000,-0.0876466000000000;1.35000000000000,-0.0945292000000000;1.40000000000000,-0.101673000000000;1.45000000000000,-0.109077000000000;1.50000000000000,-0.116743000000000;1.55000000000000,-0.124671000000000;1.60000000000000,-0.132860000000000;1.65000000000000,-0.141311000000000;1.70000000000000,-0.150023000000000;1.75000000000000,-0.158998000000000;1.80000000000000,-0.168235000000000;1.85000000000000,-0.177734000000000;1.90000000000000,-0.187496000000000;1.95000000000000,-0.197521000000000;2,-0.207808000000000;2.05000000000000,-0.218359000000000;2.10000000000000,-0.229173000000000;2.15000000000000,-0.240251000000000;2.20000000000000,-0.251592000000000;2.25000000000000,-0.263197000000000;2.30000000000000,-0.275067000000000;2.35000000000000,-0.287201000000000;2.40000000000000,-0.299600000000000;2.45000000000000,-0.312263000000000;2.50000000000000,-0.325192000000000;2.55000000000000,-0.338386000000000;2.60000000000000,-0.351846000000000;2.65000000000000,-0.365571000000000;2.70000000000000,-0.379563000000000;2.75000000000000,-0.393821000000000;2.80000000000000,-0.408346000000000;2.85000000000000,-0.423138000000000;2.90000000000000,-0.438197000000000;2.95000000000000,-0.453524000000000;3,-0.469119000000000;3.05000000000000,-0.484982000000000;3.10000000000000,-0.501113000000000;3.15000000000000,-0.517513000000000;3.20000000000000,-0.534182000000000;3.25000000000000,-0.551121000000000;3.30000000000000,-0.568330000000000;3.35000000000000,-0.585808000000000;3.40000000000000,-0.603557000000000;3.45000000000000,-0.621577000000000;3.50000000000000,-0.639868000000000;3.55000000000000,-0.658431000000000;3.60000000000000,-0.677266000000000;3.65000000000000,-0.696372000000000;3.70000000000000,-0.715752000000000;3.75000000000000,-0.735405000000000;3.80000000000000,-0.755331000000000;3.85000000000000,-0.775530000000000;3.90000000000000,-0.796005000000000;3.95000000000000,-0.816753000000000;4,-0.837777000000000;4.05000000000000,-0.859077000000000;4.10000000000000,-0.880652000000000;4.15000000000000,-0.902504000000000;4.20000000000000,-0.924632000000000;4.25000000000000,-0.947038000000000;4.30000000000000,-0.969722000000000;4.35000000000000,-0.992683000000000;4.40000000000000,-1.01592000000000;4.45000000000000,-1.03944000000000;4.50000000000000,-1.06324000000000;4.55000000000000,-1.08732000000000;4.60000000000000,-1.11168000000000;4.65000000000000,-1.13632000000000;4.70000000000000,-1.16125000000000;4.75000000000000,-1.18645000000000;4.80000000000000,-1.21194000000000;4.85000000000000,-1.23771000000000;4.90000000000000,-1.26376000000000;4.95000000000000,-1.29010000000000;5,-1.31673000000000];
Dp_s=Triangular_PLA(:,1);
lp_s=lp0+Triangular_PLA(:,2);
plot3(Dp_s(n),Dp_s(n)*0+80,lp_s(n),':^','LineWidth',1.5,'Color',[0 0.600000023841858 1])

plot3([Dt_a(end),Dt_a(end)],[20,80],[lt_a(end),lt_a(end)],'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3([Dt_a(end),Dt_a(end)],[20,80],[lt_a(end),lt_a(end)],'--','LineWidth',1.5,'Color',[0 0.600000023841858 1])

xlabel('Height D [mm]')
ylabel('Temperature [^oC]')
zlabel('Length l [mm]')

axis([0 5 20 80 38 47])
view([45 30])
box on
% legend('TPU beam (analytical model)','TPU beam (FE simulation)','PLA beam (analytical model)','PLA beam (FE simulation)')






