clear
clc

%% Our Proposed design - TPU
Dt0=9;
lt0=40;
r0=3;
E_tpu=90;
h=5;
b=2;
b_p=2; %thickness of PLA beam
I=h*b^3/12;
EI_tpu=E_tpu*I;
M=0.001:0.01:50;

alpha0=atan(2*Dt0/lt0);
l1=lt0/2/cos(alpha0)-r0-b/2;
% l1=lt0/2/cos(alpha0)-r0;
beta0=pi-2*alpha0;
s0=beta0*r0;
r=1./(M/EI_tpu+1/r0);
s=s0;
beta=s./r;
alpha=(pi-beta)/2;
DELTA=M*(l1)^2/3/EI_tpu;
Dt=(l1+r+b/2).*sin(alpha)-DELTA.*cos(alpha);
%Dt=(l1+r).*sin(alpha)-DELTA.*cos(alpha);
lt=lt0+2.*DELTA.*sin(alpha);
Dt_a=Dt(Dt>-1)+1;
lt_a=lt(Dt>-1);


figure(1)
hold on
plot3(Dt_a,20+lt_a*0,lt_a,'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])

n=1:20:101;
concave_40_9_3=[0,0;-0.100000000000000,0.0832522000000000;-0.200000000000000,0.165067000000000;-0.300000000000000,0.245456000000000;-0.400000000000000,0.324429000000000;-0.500000000000000,0.401995000000000;-0.600000000000000,0.478165000000000;-0.700000000000000,0.552948000000000;-0.800000000000000,0.626354000000000;-0.900000000000000,0.698392000000000;-1,0.769069000000000;-1.10000000000000,0.838396000000000;-1.20000000000000,0.906379000000000;-1.30000000000000,0.973028000000000;-1.40000000000000,1.03835000000000;-1.50000000000000,1.10235000000000;-1.60000000000000,1.16505000000000;-1.70000000000000,1.22643000000000;-1.80000000000000,1.28652000000000;-1.90000000000000,1.34532000000000;-2,1.40284000000000;-2.10000000000000,1.45908000000000;-2.20000000000000,1.51405000000000;-2.30000000000000,1.56775000000000;-2.40000000000000,1.62020000000000;-2.50000000000000,1.67140000000000;-2.60000000000000,1.72134000000000;-2.70000000000000,1.77005000000000;-2.80000000000000,1.81752000000000;-2.90000000000000,1.86376000000000;-3,1.90877000000000;-3.10000000000000,1.95257000000000;-3.20000000000000,1.99515000000000;-3.30000000000000,2.03651000000000;-3.40000000000000,2.07667000000000;-3.50000000000000,2.11563000000000;-3.60000000000000,2.15339000000000;-3.70000000000000,2.18995000000000;-3.80000000000000,2.22533000000000;-3.90000000000000,2.25952000000000;-4,2.29252000000000;-4.10000000000000,2.32435000000000;-4.20000000000000,2.35500000000000;-4.30000000000000,2.38447000000000;-4.40000000000000,2.41278000000000;-4.50000000000000,2.43992000000000;-4.60000000000000,2.46590000000000;-4.70000000000000,2.49072000000000;-4.80000000000000,2.51438000000000;-4.90000000000000,2.53688000000000;-5,2.55823000000000;-5.10000000000000,2.57843000000000;-5.20000000000000,2.59749000000000;-5.30000000000000,2.61539000000000;-5.40000000000000,2.63215000000000;-5.50000000000000,2.64777000000000;-5.60000000000000,2.66225000000000;-5.70000000000000,2.67559000000000;-5.80000000000000,2.68779000000000;-5.90000000000000,2.69886000000000;-6,2.70879000000000;-6.10000000000000,2.71759000000000;-6.20000000000000,2.72526000000000;-6.30000000000000,2.73179000000000;-6.40000000000000,2.73720000000000;-6.50000000000000,2.74147000000000;-6.60000000000000,2.74462000000000;-6.70000000000000,2.74664000000000;-6.80000000000000,2.74753000000000;-6.90000000000000,2.74730000000000;-7,2.74593000000000;-7.10000000000000,2.74345000000000;-7.20000000000000,2.73983000000000;-7.30000000000000,2.73509000000000;-7.40000000000000,2.72922000000000;-7.50000000000000,2.72223000000000;-7.60000000000000,2.71411000000000;-7.70000000000000,2.70486000000000;-7.80000000000000,2.69449000000000;-7.90000000000000,2.68299000000000;-8,2.67036000000000;-8.10000000000000,2.65660000000000;-8.20000000000000,2.64171000000000;-8.30000000000000,2.62568000000000;-8.40000000000000,2.60853000000000;-8.50000000000000,2.59024000000000;-8.60000000000000,2.57082000000000;-8.70000000000000,2.55026000000000;-8.80000000000000,2.52856000000000;-8.90000000000000,2.50573000000000;-9,2.48175000000000;-9.10000000000000,2.45663000000000;-9.20000000000000,2.43037000000000;-9.30000000000000,2.40296000000000;-9.40000000000000,2.37440000000000;-9.50000000000000,2.34469000000000;-9.60000000000000,2.31382000000000;-9.70000000000000,2.28181000000000;-9.80000000000000,2.24863000000000;-9.90000000000000,2.21429000000000;-10,2.17879000000000];
Dt_s=Dt0+b_p/2+concave_40_9_3(:,1);
Dt_s=Dt_s';
lt_s=lt0+concave_40_9_3(:,2);
lt_s=lt_s';
plot3(Dt_s(n),20+lt_s(n)*0,lt_s(n),'^','LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])

%% Our proposed design - PLA

lp0=lt_a(end);
E_pla=7;
b=2;h=5;
I=h*b^3/12;
EI_pla=E_pla*I;
Dp_a=0:0.01:Dt0+b/2;
lp_a=lp0-12*Dp_a.^2/5/lp0;

PLA=[0,0;0.100000000000000,-0.000553792000000000;0.200000000000000,-0.00222864000000000;0.300000000000000,-0.00502464000000000;0.400000000000000,-0.00894201000000000;0.500000000000000,-0.0139810000000000;0.600000000000000,-0.0201421000000000;0.700000000000000,-0.0274258000000000;0.800000000000000,-0.0358327000000000;0.900000000000000,-0.0453634000000000;1,-0.0560189000000000;1.10000000000000,-0.0677999000000000;1.20000000000000,-0.0807075000000000;1.30000000000000,-0.0947428000000000;1.40000000000000,-0.109907000000000;1.50000000000000,-0.126202000000000;1.60000000000000,-0.143628000000000;1.70000000000000,-0.162187000000000;1.80000000000000,-0.181881000000000;1.90000000000000,-0.202712000000000;2,-0.224681000000000;2.10000000000000,-0.247790000000000;2.20000000000000,-0.272042000000000;2.30000000000000,-0.297438000000000;2.40000000000000,-0.323981000000000;2.50000000000000,-0.351673000000000;2.60000000000000,-0.380517000000000;2.70000000000000,-0.410515000000000;2.80000000000000,-0.441670000000000;2.90000000000000,-0.473984000000000;3,-0.507462000000000;3.10000000000000,-0.542105000000000;3.20000000000000,-0.577917000000000;3.30000000000000,-0.614902000000000;3.40000000000000,-0.653062000000000;3.50000000000000,-0.692401000000000;3.60000000000000,-0.732923000000000;3.70000000000000,-0.774632000000000;3.80000000000000,-0.817532000000000;3.90000000000000,-0.861626000000000;4,-0.906919000000000;4.10000000000000,-0.953415000000000;4.20000000000000,-1.00112000000000;4.30000000000000,-1.05003000000000;4.40000000000000,-1.10017000000000;4.50000000000000,-1.15152000000000;4.60000000000000,-1.20410000000000;4.70000000000000,-1.25792000000000;4.80000000000000,-1.31297000000000;4.90000000000000,-1.36926000000000;5,-1.42680000000000;5.10000000000000,-1.48560000000000;5.20000000000000,-1.54565000000000;5.30000000000000,-1.60697000000000;5.40000000000000,-1.66956000000000;5.50000000000000,-1.73344000000000;5.60000000000000,-1.79859000000000;5.70000000000000,-1.86504000000000;5.80000000000000,-1.93279000000000;5.90000000000000,-2.00185000000000;6,-2.07221000000000;6.10000000000000,-2.14390000000000;6.20000000000000,-2.21692000000000;6.30000000000000,-2.29127000000000;6.40000000000000,-2.36697000000000;6.50000000000000,-2.44402000000000;6.60000000000000,-2.52243000000000;6.70000000000000,-2.60221000000000;6.80000000000000,-2.68337000000000;6.90000000000000,-2.76592000000000;7,-2.84987000000000;7.10000000000000,-2.93522000000000;7.20000000000000,-3.02199000000000;7.30000000000000,-3.11019000000000;7.40000000000000,-3.19983000000000;7.50000000000000,-3.29091000000000;7.60000000000000,-3.38345000000000;7.70000000000000,-3.47746000000000;7.80000000000000,-3.57295000000000;7.90000000000000,-3.66994000000000;8,-3.76843000000000;8.10000000000000,-3.86844000000000;8.20000000000000,-3.96998000000000;8.30000000000000,-4.07306000000000;8.40000000000000,-4.17770000000000;8.50000000000000,-4.28391000000000;8.60000000000000,-4.39170000000000;8.70000000000000,-4.50109000000000;8.80000000000000,-4.61210000000000;8.90000000000000,-4.72473000000000;9,-4.83900000000000;9.10000000000000,-4.95493000000000;9.20000000000000,-5.07254000000000;9.30000000000000,-5.19184000000000;9.40000000000000,-5.31285000000000;9.50000000000000,-5.43559000000000;9.60000000000000,-5.56006000000000;9.70000000000000,-5.68630000000000;9.80000000000000,-5.81433000000000;9.90000000000000,-5.94415000000000;10,-6.07579000000000];
Dp_s=PLA(:,1);
lp_s=lp0+PLA(:,2);

figure(1)
plot3(Dp_a,80+lp_a*0,lp_a,'--','LineWidth',1.5,'Color',[0 0.600000023841858 1])
plot3(Dp_s(n),80+lp_s(n)*0,lp_s(n),'^','LineWidth',1.5,'Color',[0 0.600000023841858 1])

xlabel('Height D [mm]')
ylabel('Temperature [^oC]')
zlabel('Length l [mm]')

box on

lp0
Gap=abs(lp_a(end)-lt0)

figure(1)
plot3(Dt_a,80+lt_a*0,lt_a,'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3(Dt_s(n),80+lt_s(n)*0,lt_s(n),'^','LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])

plot3([Dt_a(end),Dt_a(end)],[20,80],[lt_a(end),lt_a(end)],'LineWidth',1.5,'Color',[1 0.800000011920929 0.200000002980232])
plot3([Dt_a(end),Dt_a(end)],[20,80],[lt_a(end),lt_a(end)],'--','LineWidth',1.5,'Color',[0 0.600000023841858 1])

axis([0,10,20,80,36,43])
view([45,30])

